# dotfilesインテリジェント統合アシスタント

このdotfilesリポジトリを使用して、既存設定を保持しながら安全に統合します。

## 重要な原則

**setup.shを信頼できる唯一の情報源とする**
- すべての処理フローと具体的なコマンドは`setup.sh`に記載されている
- このコマンドは`setup.sh`の処理を拡張するもの（既存ファイルがある場合のインテリジェント統合）
- 処理内容の詳細や最新の実装は必ず`setup.sh`を参照する

## あなたの役割

**setup.shを読み取り、その処理フローに従いつつ、既存ファイルがある場合にインテリジェント統合を行う**

### 基本方針
- **既存ファイルなし**: setup.shと全く同じ動作
- **既存ファイルあり**: バックアップ → 差分分析 → 統合提案 → 実行

## 処理フロー

**必ず最初にsetup.shを読み込んで、最新の処理内容を確認してから作業を開始する**

### setup.shの各ステップに従う

setup.shは以下の順序で処理を行います：
1. 初期確認（OS、アーキテクチャ、Homebrew）
2. Homebrewインストール（必要な場合）
3. Brewfileパッケージ処理
4. 設定ファイル配置（zshrc, vimrc, gitconfig, gitignore_global）
5. zsh補完の権限修正
6. プロジェクトディレクトリ作成
7. gitconfig-work/other設定

**各ステップの具体的な処理内容はsetup.shを参照すること**

## インテリジェント統合（既存ファイルがある場合）

setup.shは既存ファイルをスキップしますが、このコマンドは以下のプロセスで統合を行います：

### 1. バックアップ作成
タイムスタンプ付きでバックアップを作成し、ユーザーに報告

### 2. 差分分析
- 既存ファイルとリポジトリファイルを読み込み
- 両者を比較して、差異と競合の可能性を評価

### 3. 統合プラン提示
- 既存ファイルの特徴
- リポジトリファイルの特徴
- 重複する設定
- 推奨する統合方法（A/B/Cから選択）

### 4. ユーザー確認
統合プランの承認を得る

### 5. 統合実行
選択された方法で統合を実行

### 6. 結果報告
変更内容の詳細を報告

## ファイル別の注意点

**gitconfig**:
- `[user]`セクションは既存を絶対に保持
- `[includeIf]`セクションは両方をマージ

**その他のファイル**:
- PATH設定やプラグイン設定の重複に注意
- 統合後は該当する後処理（権限修正等）をsetup.shに従って実行

## エラー対応

**setup.shのエラーハンドリングに従う**

エラーが発生した場合：
1. エラーメッセージを分析
2. 原因を特定
3. setup.shを参照して正しい対応方法を確認
4. 解決方法を提示

よくあるエラーの対応方法はsetup.shのコメントや処理を参照すること

## 重要な原則

1. **setup.shを信頼できる唯一の情報源とする**
2. **安全第一**: 必ずバックアップを取る
3. **透明性**: すべての変更内容を明確に説明
4. **ユーザー確認**: 重要な変更前に必ず確認を取る
5. **可逆性**: 元に戻せることを保証
